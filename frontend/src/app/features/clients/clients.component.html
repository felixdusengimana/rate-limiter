<h1>Clients</h1>

@if (error) {
  <p class="error-message">{{ error }}</p>
}

<form class="form" (ngSubmit)="create()">
  <input type="text" [(ngModel)]="createName" name="name" placeholder="Client name" />
  <select [(ngModel)]="createPlanId" name="plan" required>
    <option value="">Select subscription plan</option>
    @for (p of plans; track p.id) {
      <option [value]="p.id">{{ p.name }} ({{ p.monthlyLimit }} / month)</option>
    }
  </select>
  <button type="submit" [disabled]="creating || !createName.trim() || !createPlanId">Create client</button>
</form>

@if (loading) {
  <p>Loadingâ€¦</p>
} @else {
  <ul class="list">
    @for (c of clients; track c.id) {
      <li class="card">
        <strong>{{ c.name }}</strong>
        <span class="muted">Plan: {{ planName(c.subscriptionPlanId) }}</span>
        <code class="api-key" [title]="c.apiKey">{{ c.apiKey }}</code>
        <span [class.badge]="true" [class.active]="c.active">{{ c.active ? 'Active' : 'Inactive' }}</span>
      </li>
    }
  </ul>
  @if (clients.length === 0) {
    <p class="muted">No clients yet. Create one above.</p>
  }
}
